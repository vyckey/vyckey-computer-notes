"use strict";(self.webpackChunkvyckey_computer_notes=self.webpackChunkvyckey_computer_notes||[]).push([[7051],{8612:(n,e,a)=>{a.r(e),a.d(e,{assets:()=>c,contentTitle:()=>o,default:()=>m,frontMatter:()=>s,metadata:()=>i,toc:()=>l});var t=a(74848),r=a(28453);const s={title:"Bean Lifecycle",tags:["java","spring","spring-framework"],sidebar_label:"Bean Lifecycle",sidebar_position:2},o="Bean\u7684\u751f\u547d\u5468\u671f",i={id:"framework/spring/spring-framework/ioc-container/bean-lifecycle",title:"Bean Lifecycle",description:"Bean\u751f\u547d\u5468\u671f\u4ecb\u7ecd",source:"@site/java/framework/spring/spring-framework/ioc-container/bean-lifecycle.md",sourceDirName:"framework/spring/spring-framework/ioc-container",slug:"/framework/spring/spring-framework/ioc-container/bean-lifecycle",permalink:"/java/framework/spring/spring-framework/ioc-container/bean-lifecycle",draft:!1,unlisted:!1,tags:[{label:"java",permalink:"/java/tags/java"},{label:"spring",permalink:"/java/tags/spring"},{label:"spring-framework",permalink:"/java/tags/spring-framework"}],version:"current",lastUpdatedBy:"vyckey",lastUpdatedAt:1747456703e3,sidebarPosition:2,frontMatter:{title:"Bean Lifecycle",tags:["java","spring","spring-framework"],sidebar_label:"Bean Lifecycle",sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"IoC",permalink:"/java/framework/spring/spring-framework/ioc-container/ioc"},next:{title:"Annotation Configuration",permalink:"/java/framework/spring/spring-framework/ioc-container/annotation-config"}},c={},l=[{value:"Bean\u751f\u547d\u5468\u671f\u4ecb\u7ecd",id:"bean\u751f\u547d\u5468\u671f\u4ecb\u7ecd",level:2},{value:"Bean\u751f\u547d\u5468\u671f\u4ee3\u7801\u793a\u4f8b",id:"bean\u751f\u547d\u5468\u671f\u4ee3\u7801\u793a\u4f8b",level:2},{value:"\u53c2\u8003\u8d44\u6599",id:"\u53c2\u8003\u8d44\u6599",level:2}];function p(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.h1,{id:"bean\u7684\u751f\u547d\u5468\u671f",children:"Bean\u7684\u751f\u547d\u5468\u671f"}),"\n",(0,t.jsx)(e.h2,{id:"bean\u751f\u547d\u5468\u671f\u4ecb\u7ecd",children:"Bean\u751f\u547d\u5468\u671f\u4ecb\u7ecd"}),"\n",(0,t.jsx)(e.p,{children:"\u5bf9\u4e8eSpring Bean\u7684\u751f\u547d\u5468\u671f\u6765\u8bf4\uff0c\u53ef\u4ee5\u5206\u4e3a\u56db\u4e2a\u4e3b\u8981\u9636\u6bb5\uff1a"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsx)(e.li,{children:"\u5b9e\u4f8b\u5316\uff08Instantiation\uff09"}),"\n",(0,t.jsx)(e.li,{children:"\u5c5e\u6027\u8d4b\u503c\uff08Populate\uff09"}),"\n",(0,t.jsx)(e.li,{children:"\u521d\u59cb\u5316\uff08Initialization\uff09"}),"\n",(0,t.jsx)(e.li,{children:"\u9500\u6bc1\uff08Destruction\uff09"}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{alt:"Bean\u751f\u547d\u5468\u671f\u5f69\u56fe\u7248\u672c",src:a(66924).A+"",width:"1325",height:"1870"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-flow",children:"st=>start: \u5bb9\u5668\u542f\u52a8\ne=>end: \u5bb9\u5668\u5173\u95ed\n\nBeanDefinition=>operation: BeanDefinition\nInstantiationAwareBeanPostProcessor_pre=>operation: InstantiationAwareBeanPostProcessor#postProcessBeforeInstantiation\ninitialization=>operation: \u5b9e\u4f8b\u5316Bean\u5b9e\u4f8b\nInstantiationAwareBeanPostProcessor_after=>operation: InstantiationAwareBeanPostProcessor#postProcessAfterInstantiation\nInstantiationAwareBeanPostProcessor_prop=>operation: InstantiationAwareBeanPostProcessor#postProcessProperties\n\npopulate=>operation: Bean\u5c5e\u6027\u8d4b\u503c\n\nBeanNameAware=>operation: BeanNameAware#setBeanName\nBeanClassLoaderAware=>operation: BeanClassLoaderAware#setBeanClassLoader\nBeanFactoryAware=>operation: BeanFactoryAware#setBeanFactory\nBeanPostProcessor_pre=>operation: BeanPostProcessor#postProcessBeforeInitialization\nInitializingBean=>operation: InitializingBean#afterPropertiesSet\ninit_method=>operation: init-method\u5c5e\u6027\u914d\u7f6e\u7684\u521d\u59cb\u5316\u65b9\u6cd5\nBeanPostProcessor_after=>operation: BeanPostProcessor#postProcessAfterInitialization\n\nready=>operation: Bean\u5df2\u51c6\u5907\u597d\n\ncond=>condition: Bean\u662f\u5426\u5355\u4f8b\n\nsingleton_bean=>operation: \u8fd4\u56deBean\u7ed9\u7528\u6237\uff0c\u5269\u4f59\u751f\u547d\u5468\u671f\u4ea4\u7ed9\u7528\u6237\u63a7\u5236\nDisposableBean=>operation: DisposableBean#destroy\ndestroy_method=>operation: destroy-method\u5c5e\u6027\u914d\u7f6e\u7684\u9500\u6bc1\u65b9\u6cd5\n\nprototype_bean=>operation: Bean\u653e\u5165\u5bb9\u5668\u4e2d\uff0c\u5e76\u8fd4\u56de\u7ed9\u7528\u6237\n\nst->BeanDefinition->InstantiationAwareBeanPostProcessor_pre->initialization->InstantiationAwareBeanPostProcessor_after->InstantiationAwareBeanPostProcessor_prop\nInstantiationAwareBeanPostProcessor_prop->populate\npopulate->BeanNameAware->BeanClassLoaderAware->BeanFactoryAware->BeanPostProcessor_pre->InitializingBean->init_method->BeanPostProcessor_after\n\nBeanPostProcessor_after->ready->cond\ncond(yes)->singleton_bean->DisposableBean->destroy_method->e\ncond(no)->prototype_bean\n"})}),"\n",(0,t.jsx)(e.h2,{id:"bean\u751f\u547d\u5468\u671f\u4ee3\u7801\u793a\u4f8b",children:"Bean\u751f\u547d\u5468\u671f\u4ee3\u7801\u793a\u4f8b"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsx)(e.li,{children:"UserBean.java"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'@Component\npublic class UserBean implements InitializingBean, BeanNameAware, DisposableBean, ApplicationContextAware {\n    private int id;\n\n    private String name;\n\n    public UserBean(int id, String name) {\n        this.id = id;\n        this.name = name;\n        System.out.println("2. \u8c03\u7528\u6784\u9020\u51fd\u6570");\n    }\n\n    public int getId() {\n        return id;\n    }\n\n    public void setId(int id) {\n        this.id = id;\n        System.out.println("5. \u5c5e\u6027\u6ce8\u5165 id");\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n        System.out.println("5. \u5c5e\u6027\u6ce8\u5165 name");\n    }\n\n    @Override\n    public void setBeanName(String name) {\n        System.out.println("6. \u8c03\u7528 BeanNameAware.setBeanName() \u65b9\u6cd5");\n    }\n\n    @Override\n    public void setApplicationContext(ApplicationContext applicationContext) throws BeansException {\n        UserBean userBean = (UserBean) applicationContext.getBean("userBean");\n        System.out.println(userBean);\n        System.out.println("7. \u8c03\u7528 BeanNameAware.setBeanName() \u65b9\u6cd5");\n    }\n\n    @Override\n    public void afterPropertiesSet() throws Exception {\n        System.out.println("9. \u8c03\u7528 InitializingBean.afterPropertiesSet() \u65b9\u6cd5");\n    }\n\n    public void myInit() {\n        System.out.println("10. \u8c03\u7528 init-method \u65b9\u6cd5");\n    }\n\n    @Override\n    public void destroy() throws Exception {\n        System.out.println("12. \u8c03\u7528 DisposableBean.destroy() \u65b9\u6cd5");\n    }\n\n    public void myDestroy() {\n        System.out.println("13. \u8c03\u7528 destroy-method \u65b9\u6cd5");\n    }\n\n    @Override\n    public String toString() {\n        return "UserBean{id=" + id + ", name=\'" + name + \'\\\'\' + \'}\';\n    }\n}\n'})}),"\n",(0,t.jsxs)(e.ol,{start:"2",children:["\n",(0,t.jsx)(e.li,{children:"MyInstantiationAwareBeanPostProcessor.java"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'@Component\npublic class MyInstantiationAwareBeanPostProcessor implements InstantiationAwareBeanPostProcessor {\n    @Override\n    public Object postProcessBeforeInstantiation(Class<?> beanClass, String beanName) throws BeansException {\n        if ("userBean".equals(beanName)) {\n            System.out.println("1. \u8c03\u7528 InstantiationAwareBeanPostProcessor.postProcessBeforeInstantiation() \u65b9\u6cd5");\n        }\n        return null;\n    }\n\n    @Override\n    public boolean postProcessAfterInstantiation(Object bean, String beanName) throws BeansException {\n        if ("userBean".equals(beanName)) {\n            UserBean userBean = (UserBean) bean;\n            System.out.println("3. \u8c03\u7528 InstantiationAwareBeanPostProcessor.postProcessAfterInstantiation() \u65b9\u6cd5");\n            System.out.println(userBean);\n        }\n        return true;\n    }\n\n    @Override\n    public PropertyValues postProcessProperties(PropertyValues pvs, Object bean, String beanName) throws BeansException {\n        if ("userBean".equals(beanName)) {\n            System.out.println("4. \u8c03\u7528 InstantiationAwareBeanPostProcessor.postProcessProperties() \u65b9\u6cd5");\n        }\n        return null;\n    }\n}\n'})}),"\n",(0,t.jsxs)(e.ol,{start:"3",children:["\n",(0,t.jsx)(e.li,{children:"MyBeanPostProcessor.java"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'@Component\npublic class MyBeanPostProcessor implements BeanPostProcessor {\n    @Override\n    public Object postProcessBeforeInitialization(Object bean, String beanName) throws BeansException {\n        if ("userBean".equals(beanName)) {\n            System.out.println("8. \u8c03\u7528 BeanPostProcessor.postProcessBeforeInitialization() \u65b9\u6cd5");\n        }\n        return bean;\n    }\n\n    @Override\n    public Object postProcessAfterInitialization(Object bean, String beanName) throws BeansException {\n        if ("userBean".equals(beanName)) {\n            System.out.println("11. \u8c03\u7528 BeanPostProcessor.postProcessAfterInitialization() \u65b9\u6cd5");\n        }\n        return bean;\n    }\n}\n'})}),"\n",(0,t.jsxs)(e.ol,{start:"4",children:["\n",(0,t.jsx)(e.li,{children:"MyBeanFactoryPostProcessor.java"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'@Component\npublic class MyBeanFactoryPostProcessor implements BeanFactoryPostProcessor {\n    @Override\n    public void postProcessBeanFactory(ConfigurableListableBeanFactory beanFactory) throws BeansException {\n        System.out.println("0. \u8c03\u7528 BeanFactoryPostProcessor.postProcessBeanFactory() \u65b9\u6cd5");\n    }\n}\n'})}),"\n",(0,t.jsxs)(e.ol,{start:"5",children:["\n",(0,t.jsx)(e.li,{children:"applicationContext.xml"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xsi:schemaLocation="\n        http://www.springframework.org/schema/beans\n        https://www.springframework.org/schema/beans/spring-beans.xsd">\n\n    <bean class="com.riemann.test.MyInstantiationAwareBeanPostProcessor" />\n\n    <bean id="userBean" class="com.riemann.test.UserBean" init-method="myInit" destroy-method="myDestroy">\n        \x3c!-- \u6784\u9020\u51fd\u6570\u6ce8\u5165 --\x3e\n        <constructor-arg index="0" type="int">\n            <value>1</value>\n        </constructor-arg>\n        <constructor-arg index="1" type="java.lang.String">\n            <value>\u4e2d\u6587\u540d</value>\n        </constructor-arg>\n\n        \x3c!-- setter\u65b9\u6cd5\u6ce8\u5165 --\x3e\n        <property name="id" value="2"/>\n        <property name="name" value="riemann"/>\n    </bean>\n\n    <bean class="com.riemann.test.MyBeanPostProcessor" />\n    <bean class="com.riemann.test.MyBeanFactoryPostProcessor" />\n</beans>\n'})}),"\n",(0,t.jsxs)(e.ol,{start:"6",children:["\n",(0,t.jsx)(e.li,{children:"BeanLifeCycleTest.java"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'public class BeanLifeCycleTest {\n    public static void main(String[] args) {\n        ApplicationContext applicationContext = new ClassPathXmlApplicationContext("classpath:applicationContext.xml");\n        UserBean user = (UserBean) applicationContext.getBean("userBean");\n        ((AbstractApplicationContext) applicationContext).close();\n    }\n}\n'})}),"\n",(0,t.jsx)(e.h2,{id:"\u53c2\u8003\u8d44\u6599",children:"\u53c2\u8003\u8d44\u6599"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"https://segmentfault.com/a/1190000040365130",children:"SegmentFault - \u4e00\u6587\u8bfb\u61c2 Spring Bean \u7684\u751f\u547d\u5468\u671f"})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"https://pdai.tech/md/spring/spring-x-framework-ioc-source-3.html",children:"Java\u5168\u6808\u77e5\u8bc6\u4f53\u7cfb - Spring IOC\u5b9e\u73b0\u539f\u7406\u8be6\u89e3\u4e4bBean\u5b9e\u4f8b\u5316"})}),"\n"]})]})}function m(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(p,{...n})}):p(n)}},66924:(n,e,a)=>{a.d(e,{A:()=>t});const t=a.p+"assets/images/bean-lifecycle-019666a865809b6e14c05a839f19f57d.png"},28453:(n,e,a)=>{a.d(e,{R:()=>o,x:()=>i});var t=a(96540);const r={},s=t.createContext(r);function o(n){const e=t.useContext(s);return t.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function i(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:o(n.components),t.createElement(s.Provider,{value:e},n.children)}}}]);