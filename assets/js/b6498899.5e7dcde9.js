"use strict";(self.webpackChunkvyckey_computer_notes=self.webpackChunkvyckey_computer_notes||[]).push([[7536],{77081:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>l,default:()=>u,frontMatter:()=>r,metadata:()=>c,toc:()=>o});var a=t(74848),i=t(28453);const r={title:"Atomic",tags:["java","concurrent","atom"],sidebar_label:"Atomic",sidebar_position:1},l="\u539f\u5b50",c={id:"java/concurrent/atomic",title:"Atomic",description:"Atomic \u662f\u539f\u5b50\u7684\u610f\u601d\uff0c\u5728\u8ba1\u7b97\u673a\u4e2d\uff0c\u8868\u793a\u662f\u4e00\u4e2a\u4e0d\u53ef\u4e2d\u65ad\u7684\u7279\u6027\u3002",source:"@site/java/java/concurrent/atomic.md",sourceDirName:"java/concurrent",slug:"/java/concurrent/atomic",permalink:"/java/java/concurrent/atomic",draft:!1,unlisted:!1,tags:[{label:"java",permalink:"/java/tags/java"},{label:"concurrent",permalink:"/java/tags/concurrent"},{label:"atom",permalink:"/java/tags/atom"}],version:"current",lastUpdatedBy:"vyckey",lastUpdatedAt:1747456703e3,sidebarPosition:1,frontMatter:{title:"Atomic",tags:["java","concurrent","atom"],sidebar_label:"Atomic",sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Concurrent",permalink:"/java/java/concurrent/"},next:{title:"CompletableFuture",permalink:"/java/java/concurrent/completablefuture"}},s={},o=[{value:"\u56db\u7c7b\u539f\u5b50\u7c7b",id:"\u56db\u7c7b\u539f\u5b50\u7c7b",level:2},{value:"\u57fa\u672c\u7c7b\u578b\u539f\u5b50\u7c7b",id:"\u57fa\u672c\u7c7b\u578b\u539f\u5b50\u7c7b",level:3},{value:"\u6570\u7ec4\u7c7b\u578b\u539f\u5b50\u7c7b",id:"\u6570\u7ec4\u7c7b\u578b\u539f\u5b50\u7c7b",level:3},{value:"\u5f15\u7528\u7c7b\u578b\u539f\u5b50\u7c7b",id:"\u5f15\u7528\u7c7b\u578b\u539f\u5b50\u7c7b",level:3},{value:"\u5bf9\u8c61\u7684\u5c5e\u6027\u4fee\u6539\u7c7b\u578b\u539f\u5b50\u7c7b",id:"\u5bf9\u8c61\u7684\u5c5e\u6027\u4fee\u6539\u7c7b\u578b\u539f\u5b50\u7c7b",level:3},{value:"Unsafe\u4e00\u63a2\u7a76\u7adf",id:"unsafe\u4e00\u63a2\u7a76\u7adf",level:2},{value:"CAS\u64cd\u4f5c",id:"cas\u64cd\u4f5c",level:3},{value:"\u5185\u5b58\u64cd\u4f5c",id:"\u5185\u5b58\u64cd\u4f5c",level:3},{value:"\u76f4\u63a5\u5185\u5b58\u64cd\u4f5c",id:"\u76f4\u63a5\u5185\u5b58\u64cd\u4f5c",level:4},{value:"\u5bf9\u8c61\u4ee5\u53ca\u76f8\u5173\u64cd\u4f5c",id:"\u5bf9\u8c61\u4ee5\u53ca\u76f8\u5173\u64cd\u4f5c",level:4},{value:"\u6570\u7ec4\u4ee5\u53ca\u76f8\u5173\u64cd\u4f5c",id:"\u6570\u7ec4\u4ee5\u53ca\u76f8\u5173\u64cd\u4f5c",level:4},{value:"\u7ebf\u7a0b\u64cd\u4f5c",id:"\u7ebf\u7a0b\u64cd\u4f5c",level:3},{value:"\u5185\u5b58\u5c4f\u969c",id:"\u5185\u5b58\u5c4f\u969c",level:3},{value:"\u5176\u4ed6\u64cd\u4f5c",id:"\u5176\u4ed6\u64cd\u4f5c",level:3},{value:"\u53c2\u8003\u8d44\u6599",id:"\u53c2\u8003\u8d44\u6599",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h1,{id:"\u539f\u5b50",children:"\u539f\u5b50"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"Atomic"})," \u662f\u539f\u5b50\u7684\u610f\u601d\uff0c\u5728\u8ba1\u7b97\u673a\u4e2d\uff0c\u8868\u793a\u662f\u4e00\u4e2a\u4e0d\u53ef\u4e2d\u65ad\u7684\u7279\u6027\u3002"]}),"\n",(0,a.jsxs)(n.p,{children:["Java \u4e2d\u5e76\u53d1\u5305",(0,a.jsx)(n.code,{children:"java.util.concurrent"}),"\u7684\u539f\u5b50\u7c7b\u90fd\u5b58\u653e\u5728",(0,a.jsx)(n.code,{children:"java.util.concurrent.atomic"}),"\u5305\u3002\u6839\u636e\u64cd\u4f5c\u7684\u6570\u636e\u7c7b\u578b\uff0c\u53ef\u5206\u4e3a\u56db\u7c7b\uff1a"]}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["\u57fa\u672c\u7c7b\u578b\uff1a",(0,a.jsx)(n.code,{children:"AtomicInteger"}),"\uff0c",(0,a.jsx)(n.code,{children:"AtomicLong"}),"\uff0c",(0,a.jsx)(n.code,{children:"AtomicBoolean"}),"\u3002"]}),"\n",(0,a.jsxs)(n.li,{children:["\u6570\u7ec4\u7c7b\u578b\uff1a",(0,a.jsx)(n.code,{children:"AtomicIntegerArray"}),"\uff0c",(0,a.jsx)(n.code,{children:"AtomicLongArray"}),"\uff0c",(0,a.jsx)(n.code,{children:"AtomicReferenceArray"}),"\u3002"]}),"\n",(0,a.jsxs)(n.li,{children:["\u5f15\u7528\u7c7b\u578b\uff1a",(0,a.jsx)(n.code,{children:"AtomicReference"}),"\uff0c\u5f15\u7528\u7c7b\u578b\u539f\u5b50\u7c7b\uff1b",(0,a.jsx)(n.code,{children:"AtomicMarkableReference"}),"\uff0c\u539f\u5b50\u66f4\u65b0\u5e26\u6709\u6807\u8bb0\u7684\u5f15\u7528\u7c7b\u578b\uff1b",(0,a.jsx)(n.code,{children:"AtomicStampedReference"}),"\uff0c\u539f\u5b50\u66f4\u65b0\u5e26\u6709\u7248\u672c\u53f7\u7684\u5f15\u7528\u7c7b\u578b\u3002\u8be5\u7c7b\u5c06\u6574\u6570\u503c\u4e0e\u5f15\u7528\u5173\u8054\u8d77\u6765\uff0c\u53ef\u7528\u4e8e\u89e3\u51b3\u539f\u5b50\u7684\u66f4\u65b0\u6570\u636e\u548c\u6570\u636e\u7684\u7248\u672c\u53f7\uff0c\u53ef\u4ee5\u89e3\u51b3\u4f7f\u7528 CAS \u8fdb\u884c\u539f\u5b50\u66f4\u65b0\u65f6\u53ef\u80fd\u51fa\u73b0\u7684 ABA \u95ee\u9898\u3002"]}),"\n",(0,a.jsxs)(n.li,{children:["\u5bf9\u8c61\u5c5e\u6027\u4fee\u6539\u7c7b\u578b\uff1a",(0,a.jsx)(n.code,{children:"AtomicIntegerFieldUpdater"}),"\uff0c",(0,a.jsx)(n.code,{children:"AtomicLongFieldUpdater"}),"\uff0c",(0,a.jsx)(n.code,{children:"AtomicReferenceFieldUpdater"}),"\u3002"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"\u56db\u7c7b\u539f\u5b50\u7c7b",children:"\u56db\u7c7b\u539f\u5b50\u7c7b"}),"\n",(0,a.jsx)(n.h3,{id:"\u57fa\u672c\u7c7b\u578b\u539f\u5b50\u7c7b",children:"\u57fa\u672c\u7c7b\u578b\u539f\u5b50\u7c7b"}),"\n",(0,a.jsxs)(n.p,{children:["\u4e0a\u9762\u63d0\u5230\u7684\u4e09\u4e2a\u7c7b\u4f7f\u7528\u65b9\u5f0f\u51e0\u4e4e\u76f8\u540c\uff0c\u6240\u4ee5\u8fd9\u91cc\u4ec5\u4ee5 ",(0,a.jsx)(n.code,{children:"AtomicInteger"})," \u4e3a\u4f8b\u5b50\u6765\u4ecb\u7ecd\u3002"]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"AtomicInteger"})," \u7c7b\u5e38\u7528\u65b9\u6cd5\uff1a"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:"public final int get() //\u83b7\u53d6\u5f53\u524d\u7684\u503c\npublic final int getAndSet(int newValue)//\u83b7\u53d6\u5f53\u524d\u7684\u503c\uff0c\u5e76\u8bbe\u7f6e\u65b0\u7684\u503c\npublic final int getAndIncrement()//\u83b7\u53d6\u5f53\u524d\u7684\u503c\uff0c\u5e76\u81ea\u589e\npublic final int getAndDecrement() //\u83b7\u53d6\u5f53\u524d\u7684\u503c\uff0c\u5e76\u81ea\u51cf\npublic final int getAndAdd(int delta) //\u83b7\u53d6\u5f53\u524d\u7684\u503c\uff0c\u5e76\u52a0\u4e0a\u9884\u671f\u7684\u503c\nboolean compareAndSet(int expect, int update) //\u5982\u679c\u8f93\u5165\u7684\u6570\u503c\u7b49\u4e8e\u9884\u671f\u503c\uff0c\u5219\u4ee5\u539f\u5b50\u65b9\u5f0f\u5c06\u8be5\u503c\u8bbe\u7f6e\u4e3a\u8f93\u5165\u503c\uff08update\uff09\npublic final void lazySet(int newValue)//\u6700\u7ec8\u8bbe\u7f6e\u4e3anewValue,\u4f7f\u7528 lazySet \u8bbe\u7f6e\u4e4b\u540e\u53ef\u80fd\u5bfc\u81f4\u5176\u4ed6\u7ebf\u7a0b\u5728\u4e4b\u540e\u7684\u4e00\u5c0f\u6bb5\u65f6\u95f4\u5185\u8fd8\u662f\u53ef\u4ee5\u8bfb\u5230\u65e7\u7684\u503c\u3002\n"})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"AtomicInteger"})," \u4f7f\u7528\u793a\u4f8b\uff1a"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:'import java.util.concurrent.atomic.AtomicInteger;\n\npublic class AtomicIntegerTest {\n    public static void main(String[] args) {\n        int temvalue = 0;\n        AtomicInteger i = new AtomicInteger(0);\n        temvalue = i.getAndSet(3);\n        System.out.println("temvalue:" + temvalue + ";  i:" + i); //temvalue:0;  i:3\n        temvalue = i.getAndIncrement();\n        System.out.println("temvalue:" + temvalue + ";  i:" + i); //temvalue:3;  i:4\n        temvalue = i.getAndAdd(5);\n        System.out.println("temvalue:" + temvalue + ";  i:" + i); //temvalue:4;  i:9\n    }\n\n}\n'})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"AtomicInteger"})," \u7c7b\u6838\u5fc3\u6e90\u7801\uff1a"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:'    // setup to use Unsafe.compareAndSwapInt for updates\n    private static final Unsafe unsafe = Unsafe.getUnsafe();\n    private static final long valueOffset;\n\n    static {\n        try {\n            valueOffset = unsafe.objectFieldOffset\n                (AtomicInteger.class.getDeclaredField("value"));\n        } catch (Exception ex) { throw new Error(ex); }\n    }\n\n    private volatile int value;\n\n    public final boolean compareAndSet(int expect, int update) {\n        return unsafe.compareAndSwapInt(this, valueOffset, expect, update);\n    }\n'})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"AtomicInteger"})," \u7c7b\u4e3b\u8981\u5229\u7528 CAS (compare and swap) + ",(0,a.jsx)(n.code,{children:"volatile"})," \u548c native \u65b9\u6cd5\u6765\u4fdd\u8bc1\u539f\u5b50\u64cd\u4f5c\uff0c\u4ece\u800c\u907f\u514d ",(0,a.jsx)(n.code,{children:"synchronized"})," \u7684\u9ad8\u5f00\u9500\uff0c\u6267\u884c\u6548\u7387\u5927\u4e3a\u63d0\u5347\u3002",(0,a.jsx)(n.code,{children:"UnSafe#objectFieldOffset()"})," \u65b9\u6cd5\u662f\u4e00\u4e2a\u672c\u5730\u65b9\u6cd5\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u662f\u7528\u6765\u62ff\u5230\u201c\u539f\u6765\u7684\u503c\u201d\u7684\u5185\u5b58\u5730\u5740\u3002"]}),"\n",(0,a.jsx)(n.h3,{id:"\u6570\u7ec4\u7c7b\u578b\u539f\u5b50\u7c7b",children:"\u6570\u7ec4\u7c7b\u578b\u539f\u5b50\u7c7b"}),"\n",(0,a.jsxs)(n.p,{children:["\u4e0a\u9762\u63d0\u5230\u7684\u4e09\u4e2a\u7c7b\u4f7f\u7528\u65b9\u5f0f\u51e0\u4e4e\u76f8\u540c\uff0c\u6240\u4ee5\u8fd9\u91cc\u4ec5\u4ee5 ",(0,a.jsx)(n.code,{children:"AtomicIntegerArray"})," \u4e3a\u4f8b\u5b50\u6765\u4ecb\u7ecd\u3002"]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"AtomicIntegerArray"})," \u7c7b\u5e38\u7528\u65b9\u6cd5\uff1a"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:"public final int get(int i) //\u83b7\u53d6 index=i \u4f4d\u7f6e\u5143\u7d20\u7684\u503c\npublic final int getAndSet(int i, int newValue)//\u8fd4\u56de index=i \u4f4d\u7f6e\u7684\u5f53\u524d\u7684\u503c\uff0c\u5e76\u5c06\u5176\u8bbe\u7f6e\u4e3a\u65b0\u503c\uff1anewValue\npublic final int getAndIncrement(int i)//\u83b7\u53d6 index=i \u4f4d\u7f6e\u5143\u7d20\u7684\u503c\uff0c\u5e76\u8ba9\u8be5\u4f4d\u7f6e\u7684\u5143\u7d20\u81ea\u589e\npublic final int getAndDecrement(int i) //\u83b7\u53d6 index=i \u4f4d\u7f6e\u5143\u7d20\u7684\u503c\uff0c\u5e76\u8ba9\u8be5\u4f4d\u7f6e\u7684\u5143\u7d20\u81ea\u51cf\npublic final int getAndAdd(int i, int delta) //\u83b7\u53d6 index=i \u4f4d\u7f6e\u5143\u7d20\u7684\u503c\uff0c\u5e76\u52a0\u4e0a\u9884\u671f\u7684\u503c\nboolean compareAndSet(int i, int expect, int update) //\u5982\u679c\u8f93\u5165\u7684\u6570\u503c\u7b49\u4e8e\u9884\u671f\u503c\uff0c\u5219\u4ee5\u539f\u5b50\u65b9\u5f0f\u5c06 index=i \u4f4d\u7f6e\u7684\u5143\u7d20\u503c\u8bbe\u7f6e\u4e3a\u8f93\u5165\u503c\uff08update\uff09\npublic final void lazySet(int i, int newValue)//\u6700\u7ec8 \u5c06index=i \u4f4d\u7f6e\u7684\u5143\u7d20\u8bbe\u7f6e\u4e3anewValue,\u4f7f\u7528 lazySet \u8bbe\u7f6e\u4e4b\u540e\u53ef\u80fd\u5bfc\u81f4\u5176\u4ed6\u7ebf\u7a0b\u5728\u4e4b\u540e\u7684\u4e00\u5c0f\u6bb5\u65f6\u95f4\u5185\u8fd8\u662f\u53ef\u4ee5\u8bfb\u5230\u65e7\u7684\u503c\u3002\n"})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"AtomicIntegerArray"})," \u7c7b\u4f7f\u7528\u793a\u4f8b :"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:'import java.util.concurrent.atomic.AtomicIntegerArray;\n\npublic class AtomicIntegerArrayTest {\n    public static void main(String[] args) {\n        int temvalue = 0;\n        int[] nums = { 1, 2, 3, 4, 5, 6 };\n        AtomicIntegerArray i = new AtomicIntegerArray(nums);\n        for (int j = 0; j < nums.length; j++) {\n            System.out.println(i.get(j));\n        }\n        temvalue = i.getAndSet(0, 2);\n        System.out.println("temvalue:" + temvalue + ";  i:" + i);\n        temvalue = i.getAndIncrement(0);\n        System.out.println("temvalue:" + temvalue + ";  i:" + i);\n        temvalue = i.getAndAdd(0, 5);\n        System.out.println("temvalue:" + temvalue + ";  i:" + i);\n    }\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"\u5f15\u7528\u7c7b\u578b\u539f\u5b50\u7c7b",children:"\u5f15\u7528\u7c7b\u578b\u539f\u5b50\u7c7b"}),"\n",(0,a.jsx)(n.p,{children:"\u57fa\u672c\u7c7b\u578b\u539f\u5b50\u7c7b\u53ea\u80fd\u66f4\u65b0\u4e00\u4e2a\u53d8\u91cf\uff0c\u5982\u679c\u9700\u8981\u539f\u5b50\u66f4\u65b0\u591a\u4e2a\u53d8\u91cf\uff0c\u9700\u8981\u4f7f\u7528\u5f15\u7528\u7c7b\u578b\u539f\u5b50\u7c7b\u3002"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"AtomicReference"})," \u7c7b\u4f7f\u7528\u793a\u4f8b :"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:'import java.util.concurrent.atomic.AtomicReference;\n\npublic class AtomicReferenceTest {\n    public static void main(String[] args) {\n        AtomicReference < Person > ar = new AtomicReference < Person > ();\n        Person person = new Person("SnailClimb", 22);\n        ar.set(person);\n        Person updatePerson = new Person("Daisy", 20);\n        ar.compareAndSet(person, updatePerson);\n\n        System.out.println(ar.get().getName());\n        System.out.println(ar.get().getAge());\n    }\n}\n\n@Data\nstatic class Person {\n    private String name;\n    private int age;\n\n    public Person(String name, int age) {\n        super();\n        this.name = name;\n        this.age = age;\n    }\n}\n'})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"AtomicStampedReference"})," \u7c7b\u4f7f\u7528\u793a\u4f8b :"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:'import java.util.concurrent.atomic.AtomicStampedReference;\n\npublic class AtomicStampedReferenceDemo {\n    public static void main(String[] args) {\n        // \u5b9e\u4f8b\u5316\u3001\u53d6\u5f53\u524d\u503c\u548c stamp \u503c\n        final Integer initialRef = 0, initialStamp = 0;\n        final AtomicStampedReference<Integer> asr = new AtomicStampedReference<>(initialRef, initialStamp);\n        System.out.println("currentValue=" + asr.getReference() + ", currentStamp=" + asr.getStamp());\n\n        // compare and set\n        final Integer newReference = 666, newStamp = 999;\n        final boolean casResult = asr.compareAndSet(initialRef, newReference, initialStamp, newStamp);\n        System.out.println("currentValue=" + asr.getReference()\n                + ", currentStamp=" + asr.getStamp()\n                + ", casResult=" + casResult);\n\n        // \u83b7\u53d6\u5f53\u524d\u7684\u503c\u548c\u5f53\u524d\u7684 stamp \u503c\n        int[] arr = new int[1];\n        final Integer currentValue = asr.get(arr);\n        final int currentStamp = arr[0];\n        System.out.println("currentValue=" + currentValue + ", currentStamp=" + currentStamp);\n\n        // \u5355\u72ec\u8bbe\u7f6e stamp \u503c\n        final boolean attemptStampResult = asr.attemptStamp(newReference, 88);\n        System.out.println("currentValue=" + asr.getReference()\n                + ", currentStamp=" + asr.getStamp()\n                + ", attemptStampResult=" + attemptStampResult);\n\n        // \u91cd\u65b0\u8bbe\u7f6e\u5f53\u524d\u503c\u548c stamp \u503c\n        asr.set(initialRef, initialStamp);\n        System.out.println("currentValue=" + asr.getReference() + ", currentStamp=" + asr.getStamp());\n\n        // [\u4e0d\u63a8\u8350\u4f7f\u7528\uff0c\u9664\u975e\u641e\u6e05\u695a\u6ce8\u91ca\u7684\u610f\u601d\u4e86] weak compare and set\n        // \u56f0\u60d1\uff01weakCompareAndSet \u8fd9\u4e2a\u65b9\u6cd5\u6700\u7ec8\u8fd8\u662f\u8c03\u7528 compareAndSet \u65b9\u6cd5\u3002[\u7248\u672c: jdk-8u191]\n        // \u4f46\u662f\u6ce8\u91ca\u4e0a\u5199\u7740 "May fail spuriously and does not provide ordering guarantees,\n        // so is only rarely an appropriate alternative to compareAndSet."\n        // todo \u611f\u89c9\u6709\u53ef\u80fd\u662f jvm \u901a\u8fc7\u65b9\u6cd5\u540d\u5728 native \u65b9\u6cd5\u91cc\u9762\u505a\u4e86\u8f6c\u53d1\n        final boolean wCasResult = asr.weakCompareAndSet(initialRef, newReference, initialStamp, newStamp);\n        System.out.println("currentValue=" + asr.getReference()\n                + ", currentStamp=" + asr.getStamp()\n                + ", wCasResult=" + wCasResult);\n    }\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:"\u8f93\u51fa\u7ed3\u679c\u5982\u4e0b\uff1a"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"currentValue=0, currentStamp=0\ncurrentValue=666, currentStamp=999, casResult=true\ncurrentValue=666, currentStamp=999\ncurrentValue=666, currentStamp=88, attemptStampResult=true\ncurrentValue=0, currentStamp=0\ncurrentValue=666, currentStamp=999, wCasResult=true\n"})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"AtomicMarkableReference"})," \u7c7b\u4f7f\u7528\u793a\u4f8b :"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:'import java.util.concurrent.atomic.AtomicMarkableReference;\n\npublic class AtomicMarkableReferenceDemo {\n    public static void main(String[] args) {\n        // \u5b9e\u4f8b\u5316\u3001\u53d6\u5f53\u524d\u503c\u548c mark \u503c\n        final Boolean initialRef = null, initialMark = false;\n        final AtomicMarkableReference<Boolean> amr = new AtomicMarkableReference<>(initialRef, initialMark);\n        System.out.println("currentValue=" + amr.getReference() + ", currentMark=" + amr.isMarked());\n\n        // compare and set\n        final Boolean newReference1 = true, newMark1 = true;\n        final boolean casResult = amr.compareAndSet(initialRef, newReference1, initialMark, newMark1);\n        System.out.println("currentValue=" + amr.getReference()\n                + ", currentMark=" + amr.isMarked()\n                + ", casResult=" + casResult);\n\n        // \u83b7\u53d6\u5f53\u524d\u7684\u503c\u548c\u5f53\u524d\u7684 mark \u503c\n        boolean[] arr = new boolean[1];\n        final Boolean currentValue = amr.get(arr);\n        final boolean currentMark = arr[0];\n        System.out.println("currentValue=" + currentValue + ", currentMark=" + currentMark);\n\n        // \u5355\u72ec\u8bbe\u7f6e mark \u503c\n        final boolean attemptMarkResult = amr.attemptMark(newReference1, false);\n        System.out.println("currentValue=" + amr.getReference()\n                + ", currentMark=" + amr.isMarked()\n                + ", attemptMarkResult=" + attemptMarkResult);\n\n        // \u91cd\u65b0\u8bbe\u7f6e\u5f53\u524d\u503c\u548c mark \u503c\n        amr.set(initialRef, initialMark);\n        System.out.println("currentValue=" + amr.getReference() + ", currentMark=" + amr.isMarked());\n\n        // [\u4e0d\u63a8\u8350\u4f7f\u7528\uff0c\u9664\u975e\u641e\u6e05\u695a\u6ce8\u91ca\u7684\u610f\u601d\u4e86] weak compare and set\n        // \u56f0\u60d1\uff01weakCompareAndSet \u8fd9\u4e2a\u65b9\u6cd5\u6700\u7ec8\u8fd8\u662f\u8c03\u7528 compareAndSet \u65b9\u6cd5\u3002[\u7248\u672c: jdk-8u191]\n        // \u4f46\u662f\u6ce8\u91ca\u4e0a\u5199\u7740 "May fail spuriously and does not provide ordering guarantees,\n        // so is only rarely an appropriate alternative to compareAndSet."\n        // todo \u611f\u89c9\u6709\u53ef\u80fd\u662f jvm \u901a\u8fc7\u65b9\u6cd5\u540d\u5728 native \u65b9\u6cd5\u91cc\u9762\u505a\u4e86\u8f6c\u53d1\n        final boolean wCasResult = amr.weakCompareAndSet(initialRef, newReference1, initialMark, newMark1);\n        System.out.println("currentValue=" + amr.getReference()\n                + ", currentMark=" + amr.isMarked()\n                + ", wCasResult=" + wCasResult);\n    }\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:"\u8f93\u51fa\u7ed3\u679c\u5982\u4e0b\uff1a"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"currentValue=null, currentMark=false\ncurrentValue=true, currentMark=true, casResult=true\ncurrentValue=true, currentMark=true\ncurrentValue=true, currentMark=false, attemptMarkResult=true\ncurrentValue=null, currentMark=false\ncurrentValue=true, currentMark=true, wCasResult=true\n"})}),"\n",(0,a.jsx)(n.h3,{id:"\u5bf9\u8c61\u7684\u5c5e\u6027\u4fee\u6539\u7c7b\u578b\u539f\u5b50\u7c7b",children:"\u5bf9\u8c61\u7684\u5c5e\u6027\u4fee\u6539\u7c7b\u578b\u539f\u5b50\u7c7b"}),"\n",(0,a.jsx)(n.p,{children:"\u5982\u679c\u9700\u8981\u539f\u5b50\u66f4\u65b0\u67d0\u4e2a\u7c7b\u91cc\u7684\u67d0\u4e2a\u5b57\u6bb5\u65f6\uff0c\u9700\u8981\u7528\u5230\u5bf9\u8c61\u7684\u5c5e\u6027\u4fee\u6539\u7c7b\u578b\u539f\u5b50\u7c7b\u3002\u8981\u60f3\u539f\u5b50\u5730\u66f4\u65b0\u5bf9\u8c61\u7684\u5c5e\u6027\u9700\u8981\u4e24\u6b65\uff1a"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsx)(n.li,{children:"\u56e0\u4e3a\u5bf9\u8c61\u7684\u5c5e\u6027\u4fee\u6539\u7c7b\u578b\u539f\u5b50\u7c7b\u90fd\u662f\u62bd\u8c61\u7c7b\uff0c\u6240\u4ee5\u6bcf\u6b21\u4f7f\u7528\u90fd\u5fc5\u987b\u4f7f\u7528\u9759\u6001\u65b9\u6cd5 newUpdater()\u521b\u5efa\u4e00\u4e2a\u66f4\u65b0\u5668\uff0c\u5e76\u4e14\u9700\u8981\u8bbe\u7f6e\u60f3\u8981\u66f4\u65b0\u7684\u7c7b\u548c\u5c5e\u6027\u3002"}),"\n",(0,a.jsx)(n.li,{children:"\u66f4\u65b0\u7684\u5bf9\u8c61\u5c5e\u6027\u5fc5\u987b\u4f7f\u7528 public volatile \u4fee\u9970\u7b26\u3002"}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["\u4e09\u4e2a\u7c7b\u63d0\u4f9b\u7684\u65b9\u6cd5\u51e0\u4e4e\u76f8\u540c\uff0c\u6240\u4ee5\u6211\u4eec\u8fd9\u91cc\u4ee5 ",(0,a.jsx)(n.code,{children:"AtomicIntegerFieldUpdater"})," \u4e3a\u4f8b\u5b50\u6765\u4ecb\u7ecd\u3002"]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"AtomicIntegerFieldUpdater"})," \u7c7b\u4f7f\u7528\u793a\u4f8b\uff1a"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:'import java.util.concurrent.atomic.AtomicIntegerFieldUpdater;\n\npublic class AtomicIntegerFieldUpdaterTest {\n\tpublic static void main(String[] args) {\n\t\tAtomicIntegerFieldUpdater<User> a = AtomicIntegerFieldUpdater.newUpdater(User.class, "age");\n\n\t\tUser user = new User("Java", 22);\n\t\tSystem.out.println(a.getAndIncrement(user));// 22\n\t\tSystem.out.println(a.get(user));// 23\n\t}\n}\n\n@Data\nstatic class User {\n\tprivate String name;\n\tpublic volatile int age;\n\n\tpublic User(String name, int age) {\n\t\tsuper();\n\t\tthis.name = name;\n\t\tthis.age = age;\n\t}\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"unsafe\u4e00\u63a2\u7a76\u7adf",children:"Unsafe\u4e00\u63a2\u7a76\u7adf"}),"\n",(0,a.jsxs)(n.p,{children:["Java\u4e2d\u7684 ",(0,a.jsx)(n.code,{children:"Unsafe"})," \u7c7b\u662f\u4e00\u4e2a\u975e\u5e38\u7279\u6b8a\u7684\u7c7b\uff0c\u5b83\u63d0\u4f9b\u4e86\u4e00\u4e9b\u4e0d\u5b89\u5168\u7684\u64cd\u4f5c\uff0c\u8fd9\u4e9b\u64cd\u4f5c\u901a\u5e38\u662fJava\u8bed\u8a00\u4e2d\u4e0d\u5141\u8bb8\u7684\uff0c\u6bd4\u5982\u76f4\u63a5\u64cd\u4f5c\u5185\u5b58\u3001\u7ebf\u7a0b\u6302\u8d77\u3001CAS\u64cd\u4f5c\u7b49\u3002",(0,a.jsx)(n.code,{children:"Unsafe"})," \u7c7b\u4e3b\u8981\u7528\u4e8eJava\u7684\u5e95\u5c42\u5b9e\u73b0\uff0c\u6bd4\u5982JVM\u3001NIO\u7b49\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\u4e0d\u5efa\u8bae\u5f00\u53d1\u8005\u76f4\u63a5\u4f7f\u7528Unsafe\u7c7b\u3002 ",(0,a.jsx)(n.code,{children:"Unsafe"})," \u7c7b\u7684\u5b58\u5728\u662f\u4e3a\u4e86\u65b9\u4fbfJava\u5e95\u5c42\u7684\u5b9e\u73b0\uff0c\u540c\u65f6\u4e5f\u63d0\u4f9b\u4e86\u4e00\u4e9b\u9ad8\u7ea7\u7684\u64cd\u4f5c\uff0c\u6bd4\u5982\u539f\u5b50\u64cd\u4f5c\u3001\u5185\u5b58\u5206\u914d\u7b49\uff0c\u8fd9\u4e9b\u64cd\u4f5c\u53ef\u4ee5\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\u63d0\u9ad8\u7a0b\u5e8f\u7684\u6027\u80fd\u3002"]}),"\n",(0,a.jsx)(n.h3,{id:"cas\u64cd\u4f5c",children:"CAS\u64cd\u4f5c"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"Unsafe"})," \u7c7b\u63d0\u4f9b\u4e86\u6700\u57fa\u672c\u7684CAS\u64cd\u4f5c\u7684API\u3002"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:"public final native boolean compareAndSwapObject(Object o, long offset,Object expected, Object x);\npublic final native boolean compareAndSwapInt(Object o, long offset,int expected,int x);\npublic final native boolean compareAndSwapLong(Object o, long offset,long expected,long x);\n"})}),"\n",(0,a.jsx)(n.h3,{id:"\u5185\u5b58\u64cd\u4f5c",children:"\u5185\u5b58\u64cd\u4f5c"}),"\n",(0,a.jsx)(n.h4,{id:"\u76f4\u63a5\u5185\u5b58\u64cd\u4f5c",children:"\u76f4\u63a5\u5185\u5b58\u64cd\u4f5c"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:"/\u5206\u914d\u5185\u5b58\u6307\u5b9a\u5927\u5c0f\u7684\u5185\u5b58\npublic native long allocateMemory(long bytes);\n//\u6839\u636e\u7ed9\u5b9a\u7684\u5185\u5b58\u5730\u5740address\u8bbe\u7f6e\u91cd\u65b0\u5206\u914d\u6307\u5b9a\u5927\u5c0f\u7684\u5185\u5b58\npublic native long reallocateMemory(long address, long bytes);\n//\u7528\u4e8e\u91ca\u653eallocateMemory\u548creallocateMemory\u7533\u8bf7\u7684\u5185\u5b58\npublic native void freeMemory(long address);\n//\u5c06\u6307\u5b9a\u5bf9\u8c61\u7684\u7ed9\u5b9aoffset\u504f\u79fb\u91cf\u5185\u5b58\u5757\u4e2d\u7684\u6240\u6709\u5b57\u8282\u8bbe\u7f6e\u4e3a\u56fa\u5b9a\u503c\npublic native void setMemory(Object o, long offset, long bytes, byte value);\n//\u8bbe\u7f6e\u7ed9\u5b9a\u5185\u5b58\u5730\u5740\u7684\u503c\npublic native void putAddress(long address, long x);\n//\u83b7\u53d6\u6307\u5b9a\u5185\u5b58\u5730\u5740\u7684\u503c\npublic native long getAddress(long address);\n\n//\u8bbe\u7f6e\u7ed9\u5b9a\u5185\u5b58\u5730\u5740\u7684long\u503c\npublic native void putLong(long address, long x);\n//\u83b7\u53d6\u6307\u5b9a\u5185\u5b58\u5730\u5740\u7684long\u503c\npublic native long getLong(long address);\n//\u8bbe\u7f6e\u6216\u83b7\u53d6\u6307\u5b9a\u5185\u5b58\u7684byte\u503c\npublic native byte  getByte(long address);\npublic native void  putByte(long address, byte x);\n//\u5176\u4ed6\u57fa\u672c\u6570\u636e\u7c7b\u578b(long,char,float,double,short\u7b49)\u7684\u64cd\u4f5c\u4e0eputByte\u53cagetByte\u76f8\u540c\n.......... \u7701\u7565\u4ee3\u7801\n//\u64cd\u4f5c\u7cfb\u7edf\u7684\u5185\u5b58\u9875\u5927\u5c0f\npublic native int pageSize();\n"})}),"\n",(0,a.jsx)(n.h4,{id:"\u5bf9\u8c61\u4ee5\u53ca\u76f8\u5173\u64cd\u4f5c",children:"\u5bf9\u8c61\u4ee5\u53ca\u76f8\u5173\u64cd\u4f5c"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:"//\u4f20\u5165\u4e00\u4e2a\u5bf9\u8c61\u7684class\u5e76\u521b\u5efa\u8be5\u5b9e\u4f8b\u5bf9\u8c61\uff0c\u4f46\u4e0d\u4f1a\u8c03\u7528\u6784\u9020\u65b9\u6cd5\npublic native Object allocateInstance(Class cls) throws InstantiationException;\n\n//\u83b7\u53d6\u5b57\u6bb5f\u5728\u5b9e\u4f8b\u5bf9\u8c61\u4e2d\u7684\u504f\u79fb\u91cf\npublic native long objectFieldOffset(Field f);\n//\u9759\u6001\u5c5e\u6027\u7684\u504f\u79fb\u91cf\uff0c\u7528\u4e8e\u5728\u5bf9\u5e94\u7684Class\u5bf9\u8c61\u4e2d\u8bfb\u5199\u9759\u6001\u5c5e\u6027\npublic native long staticFieldOffset(Field f);\n//\u8fd4\u56de\u503c\u5c31\u662ff.getDeclaringClass()\npublic native Object staticFieldBase(Field f);\n\n\n//\u83b7\u5f97\u7ed9\u5b9a\u5bf9\u8c61\u504f\u79fb\u91cf\u4e0a\u7684int\u503c\uff0c\u6240\u8c13\u7684\u504f\u79fb\u91cf\u53ef\u4ee5\u7b80\u5355\u7406\u89e3\u4e3a\u6307\u9488\u6307\u5411\u8be5\u53d8\u91cf\u7684\u5185\u5b58\u5730\u5740\uff0c\n//\u901a\u8fc7\u504f\u79fb\u91cf\u4fbf\u53ef\u5f97\u5230\u8be5\u5bf9\u8c61\u7684\u53d8\u91cf\uff0c\u8fdb\u884c\u5404\u79cd\u64cd\u4f5c\npublic native int getInt(Object o, long offset);\n//\u8bbe\u7f6e\u7ed9\u5b9a\u5bf9\u8c61\u4e0a\u504f\u79fb\u91cf\u7684int\u503c\npublic native void putInt(Object o, long offset, int x);\n\n//\u83b7\u5f97\u7ed9\u5b9a\u5bf9\u8c61\u504f\u79fb\u91cf\u4e0a\u7684\u5f15\u7528\u7c7b\u578b\u7684\u503c\npublic native Object getObject(Object o, long offset);\n//\u8bbe\u7f6e\u7ed9\u5b9a\u5bf9\u8c61\u504f\u79fb\u91cf\u4e0a\u7684\u5f15\u7528\u7c7b\u578b\u7684\u503c\npublic native void putObject(Object o, long offset, Object x);\n//\u5176\u4ed6\u57fa\u672c\u6570\u636e\u7c7b\u578b(long,char,byte,float,double)\u7684\u64cd\u4f5c\u4e0egetInthe\u53caputInt\u76f8\u540c\n\n//\u8bbe\u7f6e\u7ed9\u5b9a\u5bf9\u8c61\u7684int\u503c\uff0c\u4f7f\u7528volatile\u8bed\u4e49\uff0c\u5373\u8bbe\u7f6e\u540e\u7acb\u9a6c\u66f4\u65b0\u5230\u5185\u5b58\u5bf9\u5176\u4ed6\u7ebf\u7a0b\u53ef\u89c1\npublic native void  putIntVolatile(Object o, long offset, int x);\n//\u83b7\u5f97\u7ed9\u5b9a\u5bf9\u8c61\u7684\u6307\u5b9a\u504f\u79fb\u91cfoffset\u7684int\u503c\uff0c\u4f7f\u7528volatile\u8bed\u4e49\uff0c\u603b\u80fd\u83b7\u53d6\u5230\u6700\u65b0\u7684int\u503c\u3002\npublic native int getIntVolatile(Object o, long offset);\n\n//\u5176\u4ed6\u57fa\u672c\u6570\u636e\u7c7b\u578b(long,char,byte,float,double)\u7684\u64cd\u4f5c\u4e0eputIntVolatile\n//\u53cagetIntVolatile\u76f8\u540c\uff0c\u5f15\u7528\u7c7b\u578bputObjectVolatile\u4e5f\u4e00\u6837\u3002\n..........\u7701\u7565\u4ee3\u7801\n\n//\u4e0eputIntVolatile\u4e00\u6837\uff0c\u4f46\u8981\u6c42\u88ab\u64cd\u4f5c\u5b57\u6bb5\u5fc5\u987b\u6709volatile\u4fee\u9970\npublic native void putOrderedInt(Object o,long offset,int x);\n"})}),"\n",(0,a.jsx)(n.h4,{id:"\u6570\u7ec4\u4ee5\u53ca\u76f8\u5173\u64cd\u4f5c",children:"\u6570\u7ec4\u4ee5\u53ca\u76f8\u5173\u64cd\u4f5c"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:"//\u83b7\u53d6\u6570\u7ec4\u7b2c\u4e00\u4e2a\u5143\u7d20\u7684\u504f\u79fb\u5730\u5740\npublic native int arrayBaseOffset(Class arrayClass);\n//\u6570\u7ec4\u4e2d\u4e00\u4e2a\u5143\u7d20\u5360\u636e\u7684\u5185\u5b58\u7a7a\u95f4,arrayBaseOffset\u4e0earrayIndexScale\u914d\u5408\u4f7f\u7528\uff0c\u53ef\u5b9a\u4f4d\u6570\u7ec4\u4e2d\u6bcf\u4e2a\u5143\u7d20\u5728\u5185\u5b58\u4e2d\u7684\u4f4d\u7f6e\npublic native int arrayIndexScale(Class arrayClass);\n"})}),"\n",(0,a.jsx)(n.h3,{id:"\u7ebf\u7a0b\u64cd\u4f5c",children:"\u7ebf\u7a0b\u64cd\u4f5c"}),"\n",(0,a.jsxs)(n.p,{children:["\u5c06\u4e00\u4e2a\u7ebf\u7a0b\u8fdb\u884c\u6302\u8d77\u662f\u901a\u8fc7 ",(0,a.jsx)(n.code,{children:"park"})," \u65b9\u6cd5\u5b9e\u73b0\u7684\uff0c\u8c03\u7528 ",(0,a.jsx)(n.code,{children:"park"})," \u540e\uff0c\u7ebf\u7a0b\u5c06\u4e00\u76f4\u963b\u585e\u76f4\u5230\u8d85\u65f6\u6216\u8005\u4e2d\u65ad\u7b49\u6761\u4ef6\u51fa\u73b0\u3002 ",(0,a.jsx)(n.code,{children:"unpark"})," \u53ef\u4ee5\u7ec8\u6b62\u4e00\u4e2a\u6302\u8d77\u7684\u7ebf\u7a0b\uff0c\u4f7f\u5176\u6062\u590d\u6b63\u5e38\u3002Java\u5bf9\u7ebf\u7a0b\u7684\u6302\u8d77\u64cd\u4f5c\u88ab\u5c01\u88c5\u5728 ",(0,a.jsx)(n.code,{children:"LockSupport"})," \u7c7b\u4e2d\uff0c",(0,a.jsx)(n.code,{children:"LockSupport"})," \u7c7b\u4e2d\u6709\u5404\u79cd\u7248\u672c ",(0,a.jsx)(n.code,{children:"pack"})," \u65b9\u6cd5\uff0c\u5176\u5e95\u5c42\u5b9e\u73b0\u6700\u7ec8\u8fd8\u662f\u4f7f\u7528 ",(0,a.jsx)(n.code,{children:"Unsafe.park()"})," \u65b9\u6cd5\u548c ",(0,a.jsx)(n.code,{children:"Unsafe.unpark()"})," \u65b9\u6cd5\u6765\u5b9e\u73b0\u3002"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:"//\u7ebf\u7a0b\u8c03\u7528\u8be5\u65b9\u6cd5\uff0c\u7ebf\u7a0b\u5c06\u4e00\u76f4\u963b\u585e\u76f4\u5230\u8d85\u65f6\uff0c\u6216\u8005\u662f\u4e2d\u65ad\u6761\u4ef6\u51fa\u73b0\u3002  \npublic native void park(boolean isAbsolute, long time);  \n\n//\u7ec8\u6b62\u6302\u8d77\u7684\u7ebf\u7a0b\uff0c\u6062\u590d\u6b63\u5e38.java.util.concurrent\u5305\u4e2d\u6302\u8d77\u64cd\u4f5c\u90fd\u662f\u5728LockSupport\u7c7b\u5b9e\u73b0\u7684\uff0c\u5176\u5e95\u5c42\u6b63\u662f\u4f7f\u7528\u8fd9\u4e24\u4e2a\u65b9\u6cd5\uff0c  \npublic native void unpark(Object thread); \n"})}),"\n",(0,a.jsx)(n.h3,{id:"\u5185\u5b58\u5c4f\u969c",children:"\u5185\u5b58\u5c4f\u969c"}),"\n",(0,a.jsxs)(n.p,{children:["\u5185\u5b58\u5c4f\u969c\uff08Memory Barrier\uff09\u5c31\u662f\u901a\u8fc7\u963b\u6b62\u5c4f\u969c\u4e24\u8fb9\u7684",(0,a.jsx)(n.strong,{children:"\u6307\u4ee4\u91cd\u6392\u5e8f"}),"\u4ece\u800c\u907f\u514d\u7f16\u8bd1\u5668\u548c\u786c\u4ef6\u7684\u4e0d\u6b63\u786e\u4f18\u5316\u60c5\u51b5\u3002"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:"//\u5728\u8be5\u65b9\u6cd5\u4e4b\u524d\u7684\u6240\u6709\u8bfb\u64cd\u4f5c\uff0c\u4e00\u5b9a\u5728load\u5c4f\u969c\u4e4b\u524d\u6267\u884c\u5b8c\u6210\npublic native void loadFence();\n//\u5728\u8be5\u65b9\u6cd5\u4e4b\u524d\u7684\u6240\u6709\u5199\u64cd\u4f5c\uff0c\u4e00\u5b9a\u5728store\u5c4f\u969c\u4e4b\u524d\u6267\u884c\u5b8c\u6210\npublic native void storeFence();\n//\u5728\u8be5\u65b9\u6cd5\u4e4b\u524d\u7684\u6240\u6709\u8bfb\u5199\u64cd\u4f5c\uff0c\u4e00\u5b9a\u5728full\u5c4f\u969c\u4e4b\u524d\u6267\u884c\u5b8c\u6210\uff0c\u8fd9\u4e2a\u5185\u5b58\u5c4f\u969c\u76f8\u5f53\u4e8e\u4e0a\u9762\u4e24\u4e2a\u7684\u5408\u4f53\u529f\u80fd\npublic native void fullFence();\n"})}),"\n",(0,a.jsx)(n.h3,{id:"\u5176\u4ed6\u64cd\u4f5c",children:"\u5176\u4ed6\u64cd\u4f5c"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:"//\u83b7\u53d6\u6301\u6709\u9501\uff0c\u5df2\u4e0d\u5efa\u8bae\u4f7f\u7528\n@Deprecated\npublic native void monitorEnter(Object var1);\n//\u91ca\u653e\u9501\uff0c\u5df2\u4e0d\u5efa\u8bae\u4f7f\u7528\n@Deprecated\npublic native void monitorExit(Object var1);\n//\u5c1d\u8bd5\u83b7\u53d6\u9501\uff0c\u5df2\u4e0d\u5efa\u8bae\u4f7f\u7528\n@Deprecated\npublic native boolean tryMonitorEnter(Object var1);\n\n//\u83b7\u53d6\u672c\u673a\u5185\u5b58\u7684\u9875\u6570\uff0c\u8fd9\u4e2a\u503c\u6c38\u8fdc\u90fd\u662f2\u7684\u5e42\u6b21\u65b9  \npublic native int pageSize();  \n\n//\u544a\u8bc9\u865a\u62df\u673a\u5b9a\u4e49\u4e86\u4e00\u4e2a\u6ca1\u6709\u5b89\u5168\u68c0\u67e5\u7684\u7c7b\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u8fd9\u4e2a\u7c7b\u52a0\u8f7d\u5668\u548c\u4fdd\u62a4\u57df\u6765\u7740\u8c03\u7528\u8005\u7c7b  \npublic native Class defineClass(String name, byte[] b, int off, int len, ClassLoader loader, ProtectionDomain protectionDomain);  \n\n//\u52a0\u8f7d\u4e00\u4e2a\u533f\u540d\u7c7b\npublic native Class defineAnonymousClass(Class hostClass, byte[] data, Object[] cpPatches);\n//\u5224\u65ad\u662f\u5426\u9700\u8981\u52a0\u8f7d\u4e00\u4e2a\u7c7b\npublic native boolean shouldBeInitialized(Class<?> c);\n//\u786e\u4fdd\u7c7b\u4e00\u5b9a\u88ab\u52a0\u8f7d \npublic native  void ensureClassInitialized(Class<?> c);\n"})}),"\n",(0,a.jsx)(n.h2,{id:"\u53c2\u8003\u8d44\u6599",children:"\u53c2\u8003\u8d44\u6599"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://javaguide.cn/java/concurrent/atomic-classes.html",children:"JavaGuide - Atomic\u539f\u5b50\u7c7b\u603b\u7ed3"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://javaguide.cn/java/basis/unsafe.html",children:"JavaGuide - Java \u9b54\u6cd5\u7c7b Unsafe \u8be6\u89e3"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://juejin.cn/post/7078545790594973733",children:"\u6398\u91d1 - (\u56db)\u6df1\u5165\u7406\u89e3Java\u5e76\u53d1\u7f16\u7a0b\u4e4b\u65e0\u9501CAS\u673a\u5236\u3001\u9b54\u6cd5\u7c7bUnsafe\u3001\u539f\u5b50\u5305Atomic"})}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>l,x:()=>c});var a=t(96540);const i={},r=a.createContext(i);function l(e){const n=a.useContext(r);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),a.createElement(r.Provider,{value:n},e.children)}}}]);